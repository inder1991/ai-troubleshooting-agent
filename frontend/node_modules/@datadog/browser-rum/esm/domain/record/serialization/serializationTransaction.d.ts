import type { BrowserRecord } from '../../../types';
import type { NodeId } from '../itemIds';
import type { EmitRecordCallback, EmitStatsCallback } from '../record.types';
import type { RecordingScope } from '../recordingScope';
import type { SerializationStats } from './serializationStats';
export type SerializationTransactionCallback = (transaction: SerializationTransaction) => void;
export declare const enum SerializationKind {
    INITIAL_FULL_SNAPSHOT = 0,
    SUBSEQUENT_FULL_SNAPSHOT = 1,
    INCREMENTAL_SNAPSHOT = 2
}
/**
 * A serialization transaction is used to build and emit a sequence of session replay
 * records containing a serialized snapshot of the DOM.
 */
export interface SerializationTransaction {
    /** Add a record to the transaction. It will be emitted when the transaction ends. */
    add(record: BrowserRecord): void;
    /**
     * Add a metric to the transaction's statistics. The aggregated statistics will be
     * emitted when the transaction ends.
     */
    addMetric(metric: keyof SerializationStats, value: number): void;
    /**
     * Assign and return an id to the given node. If the node has previously been assigned
     * an id, the existing id will be reused.
     */
    assignId(node: Node): NodeId;
    /** The kind of serialization being performed in this transaction. */
    kind: SerializationKind;
    /**
     * A set used to track nodes which have been serialized in the current transaction. If
     * undefined, this feature is disabled; this is the default state in new transactions
     * for performance reasons. Set the property to a non-undefined value if you need this
     * capability.
     */
    serializedNodeIds?: Set<NodeId>;
    /** The recording scope in which this transaction is occurring. */
    scope: RecordingScope;
}
/**
 * Perform serialization within a transaction. At the end of the transaction, the
 * generated records and statistics will be emitted.
 */
export declare function serializeInTransaction(kind: SerializationKind, emitRecord: EmitRecordCallback, emitStats: EmitStatsCallback, scope: RecordingScope, serialize: SerializationTransactionCallback): void;
